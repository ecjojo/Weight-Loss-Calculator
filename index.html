<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸›è‚¥è¨ˆç®—æ©Ÿ</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>æ¸›è„‚é‹å‹•é‡è¨ˆç®—æ©Ÿ</h1>
    <p class="notice">ğŸ’¡çµæœç‚ºä¼°ç®—åƒè€ƒå’Œå¨›æ¨‚ç”¨é€”ï¼Œéæ­£å¼ç§‘å­¸ç ”ç©¶ï¼Œé¼“å‹µä½¿ç”¨æœ‰æ°§é‹å‹•é€²è¡Œæ¸›è„‚ã€‚</p>
    <form>
        <label for="age">å¹´é½¡ï¼š</label>
        <input type="text" id="age" name="age"><br><br>

        <label for="height">èº«é«˜(cm)ï¼š</label>
        <input type="text" id="height" name="height"><br><br>

        <label for="weight">é«”é‡(kg)ï¼š</label>
        <input type="text" id="weight" name="weight"><br><br>

        <label for="targetWeight">ç›®æ¨™é«”é‡(kg)ï¼š</label>
        <input type="text" id="targetWeight" name="targetWeight"><br><br>

        <label for="days">ç›®æ¨™é”æˆå¤©æ•¸ï¼š</label>
        <input type="text" id="days" name="days"><br><br>

        <input type="submit" value="è¨ˆç®—">
    </form>
    <hr />

    <div id="output"></div>


    <div class="notice">
        <p> âš™ï¸åƒè€ƒå…¬å¼: </p>
        <p> ä¸€å…¬æ–¤éœ€è¦æ¶ˆè€—å¡è·¯é‡Œ = 7700 </p>
        <p> ä¸­ä½å¼·åº¦é‹å‹•å¿ƒç‡ = (220 - å¹´é½¡) x 70% </p>
        <p> ä¸­ä½å¼·åº¦é‹å‹•å¡è·¯é‡Œæ¶ˆè€— = (å…¬æ–¤ Ã— 5 METå€¼)</p>

    </div>
    <hr />
    <div id="weekly-plan"></div>

    <script>
        document.querySelector('form').addEventListener('submit', function (e) {

            e.preventDefault();
            let age = parseFloat(document.getElementById('age').value);
            let height = parseFloat(document.getElementById('height').value);
            let weight = parseFloat(document.getElementById('weight').value);
            let targetWeight = parseFloat(document.getElementById('targetWeight').value);
            let days = parseInt(document.getElementById('days').value);

            let lossWeightCount = weight - targetWeight;
            let caloriesPerDay = ((lossWeightCount) / days) * 7700;
            let weightMET = targetWeight * 5;

            let hours = Math.floor(caloriesPerDay / weightMET);
            let minutes = Math.round((caloriesPerDay / weightMET - hours) * 60);

            document.getElementById('output').innerText = 
            `æ¯å¤©éœ€è¦æ¶ˆè€— ${(caloriesPerDay).toFixed(0)} å¡è·¯é‡Œ \n 
            é€²è¡Œä½å¼·åº¦é‹å‹•(å¿ƒç‡é”${((220 - age) * 0.7).toFixed(0)}) 1å°æ™‚å¯æ¶ˆè€—ç´„  ${weight * 5} - ${weightMET} å¡è·¯é‡Œ \n 
            åªè¦æ¯å¤©é‹å‹• ${hours} å°æ™‚ ${minutes} åˆ†é˜å°±å¯ä»¥é”åˆ°ç›®æ¨™`;

            let weeklyCount = (days/7);           
            let caloriesPerWeek = caloriesPerDay * 7;
            let weeklyLossWeight = lossWeightCount/weeklyCount;

            document.getElementById('weekly-plan').innerText = `æ¯é€±éœ€è¦æ¶ˆè€— ${(caloriesPerWeek).toFixed(0)} å¡è·¯é‡Œ \n`;
            
            for (let week = 1; week < weeklyCount; week++) {
                
                let weeklyWeight = weight - (weeklyLossWeight * week);

                let weeklyweightMET = weeklyWeight * 5;

                let weeklyhours = Math.floor(caloriesPerDay / weeklyweightMET);
                let weeklyminutes = Math.round((caloriesPerDay / weeklyweightMET - weeklyhours) * 60);

                document.getElementById('weekly-plan').innerText += 
                `ç¬¬${week}é€±ç›®æ¨™ ${(weeklyWeight).toFixed(1)}kg æ¯å¤©é‹å‹• ${weeklyhours}å°æ™‚${weeklyminutes}åˆ†é˜\n`;

            }
            if (days%7!=0){
                let remainingDays = days%7;
                document.getElementById('weekly-plan').innerText += 
                `ç¬¬${(weeklyCount+1).toFixed(0)}é€±ç›®æ¨™ å‰©é¤˜${remainingDays}å¤© ${targetWeight}kg  æ¯å¤©é‹å‹• ${hours}å°æ™‚${minutes}åˆ†é˜\n`;

            }



                // Local storage
            localStorage.setItem('age', age);
            localStorage.setItem('height', height);
            localStorage.setItem('weight', weight);
            localStorage.setItem('targetWeight', targetWeight);
            localStorage.setItem('days', days);
        });

        // Retrieve data from local storage on page load
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('age').value = localStorage.getItem('age') || '';
            document.getElementById('height').value = localStorage.getItem('height') || '';
            document.getElementById('weight').value = localStorage.getItem('weight') || '';
            document.getElementById('targetWeight').value = localStorage.getItem('targetWeight') || '';
            document.getElementById('days').value = localStorage.getItem('days') || '';
        });


    </script>
</body>

</html>